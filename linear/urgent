#!/bin/bash
# Show urgent issues (priority 0-1)
# Usage: urgent

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
source "$SCRIPT_DIR/lib/linear_common.sh"

# Check initialization
check_linear_init || exit 1

echo -e "${ICON_PRIORITY_HIGH} Urgent Issues:"
echo "================================"
echo ""

# Search for urgent issues (priority 0 or 1)
PROMPT="Please use mcp__linear__linear_search_issues to find issues with priority 0 or 1, limit 20, ordered by priority then updatedAt. Show all urgent issues regardless of assignee."
RESULT=$(echo "$PROMPT" | claude --print --dangerously-skip-permissions 2>&1)

# Parse and display results
if echo "$RESULT" | grep -q -E "(POSS-|No issues|urgent)"; then
    echo "$RESULT"
else
    echo -e "${ICON_ERROR} Failed to fetch urgent issues"
    echo "$RESULT" | head -5
fi